<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Attendance</title>
<link rel="stylesheet" href="../assets/css/common.css">

<style>
/* fallback if css missing */
.att-slot-p { background:#2ecc71;color:#fff;padding:6px;border-radius:6px }
.att-slot-a { background:#e74c3c;color:#fff;padding:6px;border-radius:6px }
.att-slot-n { background:#ccc;color:#000;padding:6px;border-radius:6px }
</style>
</head>
<!-- FIX: Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
<body>

<div class="attendance-page">

 <!-- ===== HEADER ===== -->
  <div class="erp-topbar">
    <a href="dashboard.html" class="erp-back">
      <i class="bi bi-arrow-left"></i>
    </a>
    <div class="erp-title">ATTENDENCE</div>
  </div>

  <div class="attendance-content">

    <!-- INFO -->
    <div style="background:#000;color:#fff;padding:12px;border-radius:10px;text-align:center;font-weight:600;font-size:14px;margin-bottom:12px;">
      Attendance updates daily at 3:00 AM • semester summary below
    </div>

    <!-- OVERALL CARD -->
    <div class="att-card">
      <div class="att-title">Sem 4</div>
      <div class="att-sub">A.Y. 2025–26 • Even</div>

      <div class="att-bar">
        <div id="attBar" class="att-bar-fill"></div>
      </div>

      <div id="attPercent" class="att-percent">0%</div>
    </div>

    <!-- STATUS -->
    <div class="att-status-box">
      <div class="att-ok">Present: <b id="presentCount">0</b></div>
      <div class="att-bad">Absent: <b id="absentCount">0</b></div>
      <div class="att-mid">Pending: <b>0</b></div>
      <div class="att-info">No Attendance: <b>0</b></div>
    </div>

    <div class="att-legend">P = Present, A = Absent, – = No Lecture/Lab</div>

    <!-- DATE TABLE -->
    <div class="att-table" id="attTable"></div>

    <!-- SUBJECT WISE -->
    <br>
    <h4>Subject Wise Attendance</h4>
    <div id="subjectContainer"></div>

  </div>
</div>

<script>
/* =========================
   DATE WISE ATTENDANCE
   ========================= */

const attendance = {
  "2026-02-12":["P","P","P","P","A"],
  "2026-02-10":["P","P","P","P","A"],
  "2026-02-09":["P","P","P","P","-"],
  "2026-02-07":["A","A","A","-","-"],
  "2026-02-06":["P","P","P","P","-"],
  "2026-02-05":["P","P","P","P","P"],
  "2026-02-03":["P","P","P","P","P"],
  "2026-02-02":["P","P","P","P","-"],
  "2026-01-30":["P","A","A","A","-"],
  "2026-01-29":["P","A","A","A","A"],
  "2026-01-27":["A","A","A","A","-"],
  "2026-01-24":["A","A","A","A","-"],
  "2026-01-23":["A","A","A","A","-"],
  "2026-01-22":["A","A","A","A","A"],
  "2026-01-20":["A","A","A","A","A"],
  "2026-01-19":["A","A","A","A","-"],
  "2026-01-13":["A","A","A","A","A"],
  "2026-01-12":["A","A","A","A","-"],
  "2026-01-10":["A","A","A","A","-"],
  "2026-01-09":["A","A","A","A","-"],
  "2026-01-08":["A","A","A","A","A"],
  "2026-01-06":["A","P","A","A","A"],
  "2026-01-05":["A","P","-","-","-"],
  "2026-01-02":["P","P","P","P","-"],
  "2026-01-01":["A","P","P","A","A"],
  "2025-12-30":["P","P","P","P","P"],
  "2025-12-29":["A","A","-","-","-"],
  "2025-12-27":["P","P","P","P","-"],
  "2025-12-26":["P","P","P","P","-"],
  "2025-12-23":["P","P","A","A","A"],
  "2025-12-22":["A","A","-","-","-"],
  "2025-12-19":["P","-","-","-","-"],
  "2025-12-18":["P","P","P","P","A"],
  "2025-12-16":["P","P","P","P","A"],
  "2025-12-13":["P","P","P","A","-"],
  "2025-12-12":["P","P","P","P","-"],
  "2025-12-11":["P","P","P","P","P"],
  "2025-12-09":["P","P","P","P","P"],
  "2025-12-08":["P","P","P","P","-"],
  "2025-12-05":["P","P","P","P","-"],
  "2025-12-04":["P","P","P","P","P"],
  "2025-12-02":["P","P","P","P","P"],
  "2025-12-01":["P","P","P","P","-"],
  "2025-11-28":["P","P","P","A","-"],
  "2025-11-27":["P","P","P","P","P"],
  "2025-11-25":["P","P","P","P","P"],
  "2025-11-24":["P","P","P","-","-"]
};

const maxSlots = 5;
let totalPresent = 0;
let totalSlots = 0;

/* calculation (same as PHP) */
Object.values(attendance).forEach(slots => {
  slots.forEach(s => {
    if (s === "P") totalPresent++;
    if (s === "P" || s === "A") totalSlots++;
  });
});

const percent = totalSlots ? ((totalPresent / totalSlots) * 100).toFixed(2) : 0;

/* update top */
document.getElementById("presentCount").innerText = `${totalPresent} / ${totalSlots}`;
document.getElementById("absentCount").innerText = totalSlots - totalPresent;
document.getElementById("attPercent").innerText = percent + "%";
document.getElementById("attBar").style.width = percent + "%";

/* render table */
const table = document.getElementById("attTable");
let header = `<div class="att-header"><div class="att-col">Date</div>`;
for (let i=1;i<=maxSlots;i++) header += `<div class="att-col">Slot ${i}</div>`;
header += `</div>`;
table.innerHTML = header;

Object.entries(attendance).forEach(([date, slots]) => {
  let row = `
  <div class="att-row">
    <div class="att-col">
      ${new Date(date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"2-digit"})}<br>
      <span style="font-size:12px;color:#777;">
        ${new Date(date).toLocaleDateString("en-US",{weekday:"short"})}
      </span>
    </div>`;

  for (let i=0;i<maxSlots;i++) {
    let s = slots[i] || "-";
    let cls = s==="P"?"att-slot-p":s==="A"?"att-slot-a":"att-slot-n";
    row += `<div class="att-col"><div class="${cls}">${s}</div></div>`;
  }

  row += `</div>`;
  table.innerHTML += row;
});

/* =========================
   SUBJECT WISE ATTENDANCE
   ========================= */

const subjects = {
  
  "Operating Systems":            { "present": 23, "total": 31 },
  "Operating Systems Lab":        { "present": 7,  "total": 9  },
  "Software Engineering":         { "present": 18, "total": 28 },
  "Software Engineering Lab":     { "present": 5,  "total": 12  },
  "Python":                        { "present": 16, "total": 27 },
  "Python Lab":                    { "present": 5,  "total": 10  },
  "Networking":                    { "present": 17, "total": 27 },
  "Networking Lab":                { "present": 4,  "total": 7  },
  "Cryptography":                  { "present": 14, "total": 24 },
  "Cryptography Lab":              { "present": 1,  "total": 5  },
  "PGPD":                           { "present": 5,  "total": 9  },
  "PALO ALTO COURSE":              { "present": 2,  "total": 5  }
};
  



const subjectContainer = document.getElementById("subjectContainer");

Object.entries(subjects).forEach(([name, data]) => {
  const absent = data.total - data.present;
  const pct = ((data.present / data.total) * 100).toFixed(2);

  subjectContainer.innerHTML += `
    <div class="sub-card">
      <div class="sub-name">${name}</div>
      <div class="sub-info">
        Present: <b>${data.present}</b> / ${data.total}<br>
        Absent: <b>${absent}</b> / ${data.total}<br>
        Attendance: <b>${pct}%</b>
      </div>
    </div>
  `;
});
</script>

</body>
</html>
